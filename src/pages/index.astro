t add .

---
import Layout from '../layouts/Layout.astro';
---

<Layout>
	<section class="seccion seccion-main" id="main" data-index="0" data-status="active">
		<div class="background-arc"></div>
		<picture class="main-photo">
			<img src="../public/img/imagen_portada_high_1.jpeg" alt="">
		</picture>
		<div class="decoration-arc"></div>
		<div class="our-names">
			<span class="his-name">Daniel</span>
			<span class="our-and">&</span>
			<span class="her-name">Ayde</span>
		</div>
		<span class="sub-titulo-portada">Nos casaremooos!</span>
		<span class="texto-portada">Si que si, como lo escucharon, duelale al que le duela esto va porque va mi gente,
			la boda va a ser severo espectaculo, no invitamos a petro nada más porque no queríamos pero facilito
			más espectacular que el medio tiempo de cualquier superbowl de la historia, nos vamos!
		</span>
	</section>
	<section class="seccion seccion-our-story" id="our-story" data-index="1" data-status="unknown">
	</section>
	<section class="seccion seccion-info" id="info" data-index="2" data-status="unknown">
	</section>
</Layout>

<style>
	.seccion {
		width: 100%;
		height: 100vh;
		position: absolute;
	}
	.seccion-main {
		background-color: rgba(245,240,240,255);
		top: 0px;
	}
	.seccion-our-story {
		background-color: blue;
		top: 100vh;
	}
	.seccion-info {
		background-color: chocolate;
		top: 100vh;
	}
	.move-up{
		top: -100vh;
		transition: all 1s;
	}
	.move-down{
		top: 100vh;
		transition: all 1s;
	}
	.move-center{
		top: 0px;
		transition: top 1s;
	}

	.background-arc{
		height: 80vh;
		width: 40vw;
		padding: 0;
		background-color: rgba(247,247,247,255);
		border-top-left-radius: 50%;
		border-top-right-radius: 50%;
		position: absolute;
		bottom: 0px;
		left: 20vw;
	}

	.main-photo{
		position: absolute;
		bottom: 0px;
		left: 40vw;
	}
	.main-photo img{
		height: 110vh;
		width: 50vw;
		float: left;
		object-fit: cover;
		border-top-left-radius: 90%;
		border-top-right-radius: 90%;
	}

	.decoration-arc{
		position: absolute;
		bottom: 0px;
		left: 42.5vw;
		height: 105vh;
		width: 45vw;
		border-top-left-radius: 90%;
		border-top-right-radius: 90%;
		border: solid 2px rgba(247,247,247,255);
		border-bottom: none;
	}

	.our-names{
		position: absolute;
		top: 35vh;
		left: 12vw;
		display: flex;	
		gap: 0rem;
		font-size: 8.6vw;
	}
	.his-name{
		font-family: Georgia, 'Times New Roman', Times, serif;
		color: rgba(217,203,194,255);
	}
	.our-and{
		color: rgba(76,64,84,255);
	}
	.her-name{
		font-family: Georgia, 'Times New Roman', Times, serif;
		color: rgba(251,255,255,255);
	}

	.sub-titulo-portada{
		font-family: Arial, Helvetica, sans-serif;
		color: rgba(76,64,84,255);
		font-size: 2vw;
		position: absolute;
		top: 55vh;
		left: 12.5vw;
	}
	.texto-portada{
		font-family: Arial, Helvetica, sans-serif;
		line-height: 3.5vh;
		color: rgba(76,64,84,255);
		font-size: 1.2vw;
		width: 40vw;
		position: absolute;
		top: 64vh;
		left: 12.5vw;
	}

	@media (max-width: 2300px){
		.main-photo img{
			height: 100vh;
			width: 55vw;
		}

		.background-arc{
			height: 75vh;
		}

		.decoration-arc{
			left: 42.5vw;
			height: 95vh;
			width: 50vw;
		}
		
		.our-names{
			top: 45vh;
		}
		
		.sub-titulo-portada{
			top: 61vh;
			font-size: 2vw;
		}

		.texto-portada{
			top: 68vh;
			font-size: 1.5vw;
			width: 45vw;
		}

	}

	@media (max-width: 1750px){
		
		.main-photo img{
			height: 90vh;
			width: 60vw;
		}

		.decoration-arc{
			left: 42.5vw;
			height: 85vh;
			width: 55vw;
		}

		.background-arc{
			height: 70vh;
		}

		.our-names{
			top: 45vh;
		}

		.sub-titulo-portada{
			top: 60vh;
			font-size: 2.5vw;
		}
		
		.texto-portada{
			font-size: 2vw;
			width: 40vw;
		}
	}


</style>

<script>
	let touchPositionY: number = 0;
	let touchStartY: number = 0;
	let deltaY: number = 0;

	const debounce = (callback: Function, waitTime: number) => {
		let timerId: ReturnType<typeof setTimeout>;
		let execute = true;
		return () => {
			if(execute) {
				const executed = callback();
				if(executed) {
					execute = false;
				}
			}
			clearTimeout(timerId);
			timerId = setTimeout(() => {
				execute = true
			}, waitTime) 
		}
	}

	const upOrDown = () : boolean => {
		const currentSection: HTMLElement|null = document.querySelector(`[data-status="active"]`);

		if(!currentSection || !currentSection.getAttribute('data-index')) return false;

		if(deltaY < 0) {
			const nextIndex = +(currentSection.getAttribute('data-index') ?? 1) - 1;
			const nextSection: HTMLElement|null = document.querySelector(`[data-index="${nextIndex}"]`);
			if(!nextSection) return false;
			currentSection.dataset.status = "unknown";
			currentSection.classList.remove('move-center');
			currentSection.classList.add('move-down');
			nextSection.dataset.status = "active";
			nextSection.classList.remove('move-up');
			nextSection.classList.add('move-center');

			return true;
		}
		if(deltaY > 0) {
			const nextIndex = +(currentSection.getAttribute('data-index') ?? -1) + 1;
			const nextSection: HTMLElement|null = document.querySelector(`[data-index="${nextIndex}"]`);
			if(!nextSection) return false;
			currentSection.dataset.status = "unknown";
			currentSection.classList.remove('move-center');
			currentSection.classList.add('move-up');
			nextSection.dataset.status = "active";
			nextSection.classList.remove('move-down');
			nextSection.classList.add('move-center');
			return true;

		}
		return false;
	}

	const debounceUpOrDown = debounce(upOrDown, 500);
	
	const onScroll = (e: WheelEvent) => {
		deltaY = e.deltaY;
		debounceUpOrDown()
	}

	document.addEventListener('wheel', onScroll)

	document.addEventListener('touchstart', (e: TouchEvent) => {
		touchStartY	= e.touches[0].clientY;
	})

	document.addEventListener('touchmove', (e: TouchEvent) => {
		touchPositionY = e.touches[0].clientY;
	})

	document.addEventListener('touchend', () => {
		deltaY = touchStartY - touchPositionY;
		debounceUpOrDown();
	})

</script>

